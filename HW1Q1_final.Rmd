```{r}

library(tidyverse)
#The question talks about a picture that produces a better apples-to-apples comparison. There are several variables that might affect the rent of a building namely: cluster, age, renovated, class, amenities, net, employment growth in area.
#To further group this data we can conjecture that:
#1) For a particular building accounting for the cluster, we can account for amenities, average rent and employment growth in that area. And since there are quite a lot of values of cluster weâ€™ll take it on x-axis.
#2) For a particular building accounting for the class, we can account for age and renovation criteria since overall quality of the building is evaluated by class variable. Thus we will prepare graph for every class. 
#3) Also we know that the rent might become biased based on whether the rent includes utility cost or not thus we will take the net=1 buildings separately and net=0 in another graph. 
#And we have the following output
gb = read.csv("D:/MA.ECON/Data mining & Stat learning/Ass1/greenbuildings.csv")

#class_a
myplot1<-ggplot(data = gb) +  geom_point(mapping = aes(x = cluster, y = Rent, color = green_rating))+xlim(0,600)
myplot1 %+% subset(gb, class_a %in% c("1") &net %in% c("0"))

myplot3<-ggplot(data = gb) +  geom_point(mapping = aes(x = cluster, y = Rent, color = green_rating))+xlim(900,1250)
myplot3 %+% subset(gb, class_a %in% c("1")&net %in% c("0"))
myplot1<-ggplot(data = gb) +  geom_point(mapping = aes(x = cluster, y = Rent, color = green_rating))+xlim(0,600)
myplot1 %+% subset(gb, class_a %in% c("1") &net %in% c("1"))

myplot3<-ggplot(data = gb) +  geom_point(mapping = aes(x = cluster, y = Rent, color = green_rating))+xlim(900,1250)
myplot3 %+% subset(gb, class_a %in% c("1")&net %in% c("1"))

#class_b
myplot1<-ggplot(data = gb) +  geom_point(mapping = aes(x = cluster, y = Rent, color = green_rating))+xlim(0,600)
myplot1 %+% subset(gb, class_b %in% c("1") &net %in% c("0"))

myplot3<-ggplot(data = gb) +  geom_point(mapping = aes(x = cluster, y = Rent, color = green_rating))+xlim(900,1250)
myplot3 %+% subset(gb, class_b %in% c("1")&net %in% c("0"))
myplot1<-ggplot(data = gb) +  geom_point(mapping = aes(x = cluster, y = Rent, color = green_rating))+xlim(0,600)
myplot1 %+% subset(gb, class_b %in% c("1") &net %in% c("1"))

myplot3<-ggplot(data = gb) +  geom_point(mapping = aes(x = cluster, y = Rent, color = green_rating))+xlim(900,1250)
myplot3 %+% subset(gb, class_b %in% c("1")&net %in% c("1"))

#class_c
myplot7<-ggplot(data = gb) +  geom_point(mapping = aes(x = cluster, y = Rent, color = green_rating))+xlim(0,600)
myplot8 %+% subset(gb, class_a %in% c("0") &class_b %in% c("0")&net %in% c("0") )


myplot9<-ggplot(data = gb) +  geom_point(mapping = aes(x = cluster, y = Rent, color = green_rating))+xlim(950,1250)
myplot9 %+% subset(gb, class_a %in% c("0") &class_b %in% c("0")&net %in% c("0") )

myplot7<-ggplot(data = gb) +  geom_point(mapping = aes(x = cluster, y = Rent, color = green_rating))+xlim(0,600)
myplot8 %+% subset(gb, class_a %in% c("0") &class_b %in% c("0")&net %in% c("1") )


myplot9<-ggplot(data = gb) +  geom_point(mapping = aes(x = cluster, y = Rent, color = green_rating))+xlim(950,1250)
myplot9 %+% subset(gb, class_a %in% c("0") &class_b %in% c("0")&net %in% c("1") )
#Conclusion: Based on the 12 graphs above, We can see there are significant points in ggplots that represent the green building receiving rent less than normal buildings and also close to the mean rent of the cluster. Although in some cases such as class B cases there is more possibility of higher rent recovery from green buildings. Thus we cannot confidently conclude that the expectation of rent covered from a green building would be more than that of a normal building without any further information about the proposed building. Hence its uncertain whether investing in a green building will be worth it or not. 


```